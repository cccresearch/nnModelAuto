$ python -W ignore trainer.py
build cnn model: {'in_shape': [28, 28], 'out_shape': [10], 'layers': [{'type': 'Conv2d', 'out_channels': 6, 'kernel_size': 5, 'stride': 1}, {'type': 'AvgPool2d', 'kernel_size': 2}, {'type': 'Conv2d', 'out_channels': 16, 'kernel_size': 5}, {'type': 'AvgPool2d', 'kernel_size': 
2}, {'type': 'Flatten'}, {'type': 'Linear', 'out_features': 120}, {'type': 'ReLU'}, {'type': 'Linear', 'out_features': 84}, {'type': 'ReLU'}]}
0 :rlayer= Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
1 :rlayer= AvgPool2d(kernel_size=2, stride=2, padding=0)
2 :rlayer= Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
3 :rlayer= AvgPool2d(kernel_size=2, stride=2, padding=0)
4 :rlayer= Flatten(start_dim=1, end_dim=-1)
5 :rlayer= Linear(in_features=256, out_features=120, bias=True)
6 :rlayer= ReLU()
7 :rlayer= Linear(in_features=120, out_features=84, bias=True)
8 :rlayer= ReLU()
shape= torch.Size([1, 84])
build:net= Sequential(
  (0): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))
  (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
  (2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (3): AvgPool2d(kernel_size=2, stride=2, padding=0)
  (4): Flatten(start_dim=1, end_dim=-1)
  (5): Linear(in_features=256, out_features=120, bias=True)
  (6): ReLU()
  (7): Linear(in_features=120, out_features=84, bias=True)
  (8): ReLU()
  (out): Linear(in_features=84, out_features=10, bias=True)
)
Train Epoch: 1 [0/60000 (0%)]   Loss: 2.322595
Train Epoch: 1 [640/60000 (1%)] Loss: 2.284005
Train Epoch: 1 [1280/60000 (2%)]        Loss: 2.286443
Train Epoch: 1 [1920/60000 (3%)]        Loss: 2.271095
Train Epoch: 1 [2560/60000 (4%)]        Loss: 2.262141
Train Epoch: 1 [3200/60000 (5%)]        Loss: 2.249616
Train Epoch: 1 [3840/60000 (6%)]        Loss: 2.240844
Train Epoch: 1 [4480/60000 (7%)]        Loss: 2.207124
Train Epoch: 1 [5120/60000 (9%)]        Loss: 2.175348
Train Epoch: 1 [5760/60000 (10%)]       Loss: 2.096039
Train Epoch: 1 [6400/60000 (11%)]       Loss: 2.034701
Train Epoch: 1 [7040/60000 (12%)]       Loss: 1.944607
Train Epoch: 1 [7680/60000 (13%)]       Loss: 1.752025
Train Epoch: 1 [8320/60000 (14%)]       Loss: 1.469730
Train Epoch: 1 [8960/60000 (15%)]       Loss: 0.981386
Train Epoch: 1 [9600/60000 (16%)]       Loss: 0.806772
Train Epoch: 1 [10240/60000 (17%)]      Loss: 0.795866
Train Epoch: 1 [10880/60000 (18%)]      Loss: 0.938265
Train Epoch: 1 [11520/60000 (19%)]      Loss: 0.467559
Train Epoch: 1 [12160/60000 (20%)]      Loss: 0.541802
Train Epoch: 1 [12800/60000 (21%)]      Loss: 0.514396
Train Epoch: 1 [13440/60000 (22%)]      Loss: 0.662968
Train Epoch: 1 [14080/60000 (23%)]      Loss: 0.432385
Train Epoch: 1 [14720/60000 (25%)]      Loss: 0.477188
Train Epoch: 1 [15360/60000 (26%)]      Loss: 0.567439
Train Epoch: 1 [16000/60000 (27%)]      Loss: 0.586280
Train Epoch: 1 [16640/60000 (28%)]      Loss: 0.235638
Train Epoch: 1 [17280/60000 (29%)]      Loss: 0.519563
Train Epoch: 1 [17920/60000 (30%)]      Loss: 0.332429
Train Epoch: 1 [18560/60000 (31%)]      Loss: 0.332726
Train Epoch: 1 [19200/60000 (32%)]      Loss: 0.349896
Train Epoch: 1 [19840/60000 (33%)]      Loss: 0.599586
Train Epoch: 1 [20480/60000 (34%)]      Loss: 0.460185
Train Epoch: 1 [21120/60000 (35%)]      Loss: 0.323289
Train Epoch: 1 [21760/60000 (36%)]      Loss: 0.330096
Train Epoch: 1 [22400/60000 (37%)]      Loss: 0.360326
Train Epoch: 1 [23040/60000 (38%)]      Loss: 0.300483
Train Epoch: 1 [23680/60000 (39%)]      Loss: 0.143431
Train Epoch: 1 [24320/60000 (41%)]      Loss: 0.452803
Train Epoch: 1 [24960/60000 (42%)]      Loss: 0.557206
Train Epoch: 1 [25600/60000 (43%)]      Loss: 0.307133
Train Epoch: 1 [26240/60000 (44%)]      Loss: 0.425801
Train Epoch: 1 [26880/60000 (45%)]      Loss: 0.713513
Train Epoch: 1 [27520/60000 (46%)]      Loss: 0.481986
Train Epoch: 1 [28160/60000 (47%)]      Loss: 0.500804
Train Epoch: 1 [28800/60000 (48%)]      Loss: 0.481627
Train Epoch: 1 [29440/60000 (49%)]      Loss: 0.339941
Train Epoch: 1 [30080/60000 (50%)]      Loss: 0.369471
Train Epoch: 1 [30720/60000 (51%)]      Loss: 0.262337
Train Epoch: 1 [31360/60000 (52%)]      Loss: 0.302128
Train Epoch: 1 [32000/60000 (53%)]      Loss: 0.295306
Train Epoch: 1 [32640/60000 (54%)]      Loss: 0.335934
Train Epoch: 1 [33280/60000 (55%)]      Loss: 0.298576
Train Epoch: 1 [33920/60000 (57%)]      Loss: 0.327338
Train Epoch: 1 [34560/60000 (58%)]      Loss: 0.332996
Train Epoch: 1 [35200/60000 (59%)]      Loss: 0.241437
Train Epoch: 1 [35840/60000 (60%)]      Loss: 0.275295
Train Epoch: 1 [36480/60000 (61%)]      Loss: 0.358761
Train Epoch: 1 [37120/60000 (62%)]      Loss: 0.299717
Train Epoch: 1 [37760/60000 (63%)]      Loss: 0.159931
Train Epoch: 1 [38400/60000 (64%)]      Loss: 0.285836
Train Epoch: 1 [39040/60000 (65%)]      Loss: 0.191179
Train Epoch: 1 [39680/60000 (66%)]      Loss: 0.122348
Train Epoch: 1 [40320/60000 (67%)]      Loss: 0.242335
Train Epoch: 1 [40960/60000 (68%)]      Loss: 0.410138
Train Epoch: 1 [41600/60000 (69%)]      Loss: 0.242050
Train Epoch: 1 [42240/60000 (70%)]      Loss: 0.203688
Train Epoch: 1 [42880/60000 (71%)]      Loss: 0.357050
Train Epoch: 1 [43520/60000 (72%)]      Loss: 0.378028
Train Epoch: 1 [44160/60000 (74%)]      Loss: 0.274297
Train Epoch: 1 [44800/60000 (75%)]      Loss: 0.410292
Train Epoch: 1 [45440/60000 (76%)]      Loss: 0.123399
Train Epoch: 1 [46080/60000 (77%)]      Loss: 0.314404
Train Epoch: 1 [46720/60000 (78%)]      Loss: 0.182139
Train Epoch: 1 [47360/60000 (79%)]      Loss: 0.268546
Train Epoch: 1 [48000/60000 (80%)]      Loss: 0.239499
Train Epoch: 1 [48640/60000 (81%)]      Loss: 0.246158
Train Epoch: 1 [49280/60000 (82%)]      Loss: 0.280484
Train Epoch: 1 [49920/60000 (83%)]      Loss: 0.360709
Train Epoch: 1 [50560/60000 (84%)]      Loss: 0.173035
Train Epoch: 1 [51200/60000 (85%)]      Loss: 0.168453
Train Epoch: 1 [51840/60000 (86%)]      Loss: 0.321480
Train Epoch: 1 [52480/60000 (87%)]      Loss: 0.316756
Train Epoch: 1 [53120/60000 (88%)]      Loss: 0.284647
Train Epoch: 1 [53760/60000 (90%)]      Loss: 0.305797
Train Epoch: 1 [54400/60000 (91%)]      Loss: 0.222726
Train Epoch: 1 [55040/60000 (92%)]      Loss: 0.523748
Train Epoch: 1 [55680/60000 (93%)]      Loss: 0.250848
Train Epoch: 1 [56320/60000 (94%)]      Loss: 0.228205
Train Epoch: 1 [56960/60000 (95%)]      Loss: 0.194867
Train Epoch: 1 [57600/60000 (96%)]      Loss: 0.188821
Train Epoch: 1 [58240/60000 (97%)]      Loss: 0.095374
Train Epoch: 1 [58880/60000 (98%)]      Loss: 0.315133
Train Epoch: 1 [59520/60000 (99%)]      Loss: 0.091691
Train Epoch: 2 [0/60000 (0%)]   Loss: 0.245546
Train Epoch: 2 [640/60000 (1%)] Loss: 0.293890
Train Epoch: 2 [1280/60000 (2%)]        Loss: 0.150048
Train Epoch: 2 [1920/60000 (3%)]        Loss: 0.165580
Train Epoch: 2 [2560/60000 (4%)]        Loss: 0.122123
Train Epoch: 2 [3200/60000 (5%)]        Loss: 0.535723
Train Epoch: 2 [3840/60000 (6%)]        Loss: 0.187247
Train Epoch: 2 [4480/60000 (7%)]        Loss: 0.206528
Train Epoch: 2 [5120/60000 (9%)]        Loss: 0.229148
Train Epoch: 2 [5760/60000 (10%)]       Loss: 0.254207
Train Epoch: 2 [6400/60000 (11%)]       Loss: 0.236170
Train Epoch: 2 [7040/60000 (12%)]       Loss: 0.197079
Train Epoch: 2 [7680/60000 (13%)]       Loss: 0.240052
Train Epoch: 2 [8320/60000 (14%)]       Loss: 0.158352
Train Epoch: 2 [8960/60000 (15%)]       Loss: 0.143032
Train Epoch: 2 [9600/60000 (16%)]       Loss: 0.137682
Train Epoch: 2 [10240/60000 (17%)]      Loss: 0.392527
Train Epoch: 2 [10880/60000 (18%)]      Loss: 0.246234
Train Epoch: 2 [11520/60000 (19%)]      Loss: 0.134853
Train Epoch: 2 [12160/60000 (20%)]      Loss: 0.171583
Train Epoch: 2 [12800/60000 (21%)]      Loss: 0.108917
Train Epoch: 2 [13440/60000 (22%)]      Loss: 0.099585
Train Epoch: 2 [14080/60000 (23%)]      Loss: 0.398390
Train Epoch: 2 [14720/60000 (25%)]      Loss: 0.187412
Train Epoch: 2 [15360/60000 (26%)]      Loss: 0.136257
Train Epoch: 2 [16000/60000 (27%)]      Loss: 0.106630
Train Epoch: 2 [16640/60000 (28%)]      Loss: 0.103290
Train Epoch: 2 [17280/60000 (29%)]      Loss: 0.189084
Train Epoch: 2 [17920/60000 (30%)]      Loss: 0.134090
Train Epoch: 2 [18560/60000 (31%)]      Loss: 0.279941
Train Epoch: 2 [19200/60000 (32%)]      Loss: 0.195066
Train Epoch: 2 [19840/60000 (33%)]      Loss: 0.345087
Train Epoch: 2 [20480/60000 (34%)]      Loss: 0.233975
Train Epoch: 2 [21120/60000 (35%)]      Loss: 0.158110
Train Epoch: 2 [21760/60000 (36%)]      Loss: 0.189968
Train Epoch: 2 [22400/60000 (37%)]      Loss: 0.132026
Train Epoch: 2 [23040/60000 (38%)]      Loss: 0.088910
Train Epoch: 2 [23680/60000 (39%)]      Loss: 0.059447
Train Epoch: 2 [24320/60000 (41%)]      Loss: 0.237541
Train Epoch: 2 [24960/60000 (42%)]      Loss: 0.186803
Train Epoch: 2 [25600/60000 (43%)]      Loss: 0.150862
Train Epoch: 2 [26240/60000 (44%)]      Loss: 0.116747
Train Epoch: 2 [26880/60000 (45%)]      Loss: 0.232584
Train Epoch: 2 [27520/60000 (46%)]      Loss: 0.104685
Train Epoch: 2 [28160/60000 (47%)]      Loss: 0.155799
Train Epoch: 2 [28800/60000 (48%)]      Loss: 0.172678
Train Epoch: 2 [29440/60000 (49%)]      Loss: 0.151399
Train Epoch: 2 [30080/60000 (50%)]      Loss: 0.263606
Train Epoch: 2 [30720/60000 (51%)]      Loss: 0.118589
Train Epoch: 2 [31360/60000 (52%)]      Loss: 0.178757
Train Epoch: 2 [32000/60000 (53%)]      Loss: 0.110693
Train Epoch: 2 [32640/60000 (54%)]      Loss: 0.281154
Train Epoch: 2 [33280/60000 (55%)]      Loss: 0.197585
Train Epoch: 2 [33920/60000 (57%)]      Loss: 0.124418
Train Epoch: 2 [34560/60000 (58%)]      Loss: 0.098523
Train Epoch: 2 [35200/60000 (59%)]      Loss: 0.488075
Train Epoch: 2 [35840/60000 (60%)]      Loss: 0.186918
Train Epoch: 2 [36480/60000 (61%)]      Loss: 0.224265
Train Epoch: 2 [37120/60000 (62%)]      Loss: 0.576200
Train Epoch: 2 [37760/60000 (63%)]      Loss: 0.224315
Train Epoch: 2 [38400/60000 (64%)]      Loss: 0.397417
Train Epoch: 2 [39040/60000 (65%)]      Loss: 0.283768
Train Epoch: 2 [39680/60000 (66%)]      Loss: 0.246257
Train Epoch: 2 [40320/60000 (67%)]      Loss: 0.232976
Train Epoch: 2 [40960/60000 (68%)]      Loss: 0.154917
Train Epoch: 2 [41600/60000 (69%)]      Loss: 0.206602
Train Epoch: 2 [42240/60000 (70%)]      Loss: 0.115599
Train Epoch: 2 [42880/60000 (71%)]      Loss: 0.102327
Train Epoch: 2 [43520/60000 (72%)]      Loss: 0.122507
Train Epoch: 2 [44160/60000 (74%)]      Loss: 0.104310
Train Epoch: 2 [44800/60000 (75%)]      Loss: 0.189186
Train Epoch: 2 [45440/60000 (76%)]      Loss: 0.164856
Train Epoch: 2 [46080/60000 (77%)]      Loss: 0.191627
Train Epoch: 2 [46720/60000 (78%)]      Loss: 0.089864
Train Epoch: 2 [47360/60000 (79%)]      Loss: 0.035213
Train Epoch: 2 [48000/60000 (80%)]      Loss: 0.148753
Train Epoch: 2 [48640/60000 (81%)]      Loss: 0.056764
Train Epoch: 2 [49280/60000 (82%)]      Loss: 0.216542
Train Epoch: 2 [49920/60000 (83%)]      Loss: 0.274919
Train Epoch: 2 [50560/60000 (84%)]      Loss: 0.232375
Train Epoch: 2 [51200/60000 (85%)]      Loss: 0.091125
Train Epoch: 2 [51840/60000 (86%)]      Loss: 0.275313
Train Epoch: 2 [52480/60000 (87%)]      Loss: 0.088602
Train Epoch: 2 [53120/60000 (88%)]      Loss: 0.291800
Train Epoch: 2 [53760/60000 (90%)]      Loss: 0.083960
Train Epoch: 2 [54400/60000 (91%)]      Loss: 0.293940
Train Epoch: 2 [55040/60000 (92%)]      Loss: 0.099032
Train Epoch: 2 [55680/60000 (93%)]      Loss: 0.093246
Train Epoch: 2 [56320/60000 (94%)]      Loss: 0.303746
Train Epoch: 2 [56960/60000 (95%)]      Loss: 0.228779
Train Epoch: 2 [57600/60000 (96%)]      Loss: 0.185472
Train Epoch: 2 [58240/60000 (97%)]      Loss: 0.041698
Train Epoch: 2 [58880/60000 (98%)]      Loss: 0.133820
Train Epoch: 2 [59520/60000 (99%)]      Loss: 0.143212
Train Epoch: 3 [0/60000 (0%)]   Loss: 0.097155
Train Epoch: 3 [640/60000 (1%)] Loss: 0.139027
Train Epoch: 3 [1280/60000 (2%)]        Loss: 0.276403
Train Epoch: 3 [1920/60000 (3%)]        Loss: 0.131154
Train Epoch: 3 [2560/60000 (4%)]        Loss: 0.142027
Train Epoch: 3 [3200/60000 (5%)]        Loss: 0.261787
Train Epoch: 3 [3840/60000 (6%)]        Loss: 0.118544
Train Epoch: 3 [4480/60000 (7%)]        Loss: 0.237777
Train Epoch: 3 [5120/60000 (9%)]        Loss: 0.156230
Train Epoch: 3 [5760/60000 (10%)]       Loss: 0.177118
Train Epoch: 3 [6400/60000 (11%)]       Loss: 0.124025
Train Epoch: 3 [7040/60000 (12%)]       Loss: 0.111808
Train Epoch: 3 [7680/60000 (13%)]       Loss: 0.157307
Train Epoch: 3 [8320/60000 (14%)]       Loss: 0.289847
Train Epoch: 3 [8960/60000 (15%)]       Loss: 0.067381
Train Epoch: 3 [9600/60000 (16%)]       Loss: 0.076115
Train Epoch: 3 [10240/60000 (17%)]      Loss: 0.183693
Train Epoch: 3 [10880/60000 (18%)]      Loss: 0.083296
Train Epoch: 3 [11520/60000 (19%)]      Loss: 0.123049
Train Epoch: 3 [12160/60000 (20%)]      Loss: 0.062075
Train Epoch: 3 [12800/60000 (21%)]      Loss: 0.095127
Train Epoch: 3 [13440/60000 (22%)]      Loss: 0.139648
Train Epoch: 3 [14080/60000 (23%)]      Loss: 0.120793
Train Epoch: 3 [14720/60000 (25%)]      Loss: 0.106075
Train Epoch: 3 [15360/60000 (26%)]      Loss: 0.240803
Train Epoch: 3 [16000/60000 (27%)]      Loss: 0.051169
Train Epoch: 3 [16640/60000 (28%)]      Loss: 0.121529
Train Epoch: 3 [17280/60000 (29%)]      Loss: 0.217668
Train Epoch: 3 [17920/60000 (30%)]      Loss: 0.178859
Train Epoch: 3 [18560/60000 (31%)]      Loss: 0.265818
Train Epoch: 3 [19200/60000 (32%)]      Loss: 0.076227
Train Epoch: 3 [19840/60000 (33%)]      Loss: 0.111396
Train Epoch: 3 [20480/60000 (34%)]      Loss: 0.061297
Train Epoch: 3 [21120/60000 (35%)]      Loss: 0.166873
Train Epoch: 3 [21760/60000 (36%)]      Loss: 0.205818
Train Epoch: 3 [22400/60000 (37%)]      Loss: 0.151727
Train Epoch: 3 [23040/60000 (38%)]      Loss: 0.115861
Train Epoch: 3 [23680/60000 (39%)]      Loss: 0.093653
Train Epoch: 3 [24320/60000 (41%)]      Loss: 0.080318
Train Epoch: 3 [24960/60000 (42%)]      Loss: 0.030679
Train Epoch: 3 [25600/60000 (43%)]      Loss: 0.057137
Train Epoch: 3 [26240/60000 (44%)]      Loss: 0.056412
Train Epoch: 3 [26880/60000 (45%)]      Loss: 0.148723
Train Epoch: 3 [27520/60000 (46%)]      Loss: 0.173539
Train Epoch: 3 [28160/60000 (47%)]      Loss: 0.087546
Train Epoch: 3 [28800/60000 (48%)]      Loss: 0.087783
Train Epoch: 3 [29440/60000 (49%)]      Loss: 0.033499
Train Epoch: 3 [30080/60000 (50%)]      Loss: 0.027300
Train Epoch: 3 [30720/60000 (51%)]      Loss: 0.107254
Train Epoch: 3 [31360/60000 (52%)]      Loss: 0.110621
Train Epoch: 3 [32000/60000 (53%)]      Loss: 0.077772
Train Epoch: 3 [32640/60000 (54%)]      Loss: 0.078590
Train Epoch: 3 [33280/60000 (55%)]      Loss: 0.045267
Train Epoch: 3 [33920/60000 (57%)]      Loss: 0.037623
Train Epoch: 3 [34560/60000 (58%)]      Loss: 0.057911
Train Epoch: 3 [35200/60000 (59%)]      Loss: 0.148869
Train Epoch: 3 [35840/60000 (60%)]      Loss: 0.113911
Train Epoch: 3 [36480/60000 (61%)]      Loss: 0.150680
Train Epoch: 3 [37120/60000 (62%)]      Loss: 0.111020
Train Epoch: 3 [37760/60000 (63%)]      Loss: 0.211239
Train Epoch: 3 [38400/60000 (64%)]      Loss: 0.063379
Train Epoch: 3 [39040/60000 (65%)]      Loss: 0.084668
Train Epoch: 3 [39680/60000 (66%)]      Loss: 0.153976
Train Epoch: 3 [40320/60000 (67%)]      Loss: 0.319267
Train Epoch: 3 [40960/60000 (68%)]      Loss: 0.057792
Train Epoch: 3 [41600/60000 (69%)]      Loss: 0.134084
Train Epoch: 3 [42240/60000 (70%)]      Loss: 0.221745
Train Epoch: 3 [42880/60000 (71%)]      Loss: 0.261283
Train Epoch: 3 [43520/60000 (72%)]      Loss: 0.132636
Train Epoch: 3 [44160/60000 (74%)]      Loss: 0.032151
Train Epoch: 3 [44800/60000 (75%)]      Loss: 0.102277
Train Epoch: 3 [45440/60000 (76%)]      Loss: 0.199468
Train Epoch: 3 [46080/60000 (77%)]      Loss: 0.191931
Train Epoch: 3 [46720/60000 (78%)]      Loss: 0.121263
Train Epoch: 3 [47360/60000 (79%)]      Loss: 0.206484
Train Epoch: 3 [48000/60000 (80%)]      Loss: 0.229835
Train Epoch: 3 [48640/60000 (81%)]      Loss: 0.059791
Train Epoch: 3 [49280/60000 (82%)]      Loss: 0.084915
Train Epoch: 3 [49920/60000 (83%)]      Loss: 0.134867
Train Epoch: 3 [50560/60000 (84%)]      Loss: 0.247817
Train Epoch: 3 [51200/60000 (85%)]      Loss: 0.055327
Train Epoch: 3 [51840/60000 (86%)]      Loss: 0.038603
Train Epoch: 3 [52480/60000 (87%)]      Loss: 0.228670
Train Epoch: 3 [53120/60000 (88%)]      Loss: 0.211516
Train Epoch: 3 [53760/60000 (90%)]      Loss: 0.100153
Train Epoch: 3 [54400/60000 (91%)]      Loss: 0.122946
Train Epoch: 3 [55040/60000 (92%)]      Loss: 0.045027
Train Epoch: 3 [55680/60000 (93%)]      Loss: 0.188274
Train Epoch: 3 [56320/60000 (94%)]      Loss: 0.075742
Train Epoch: 3 [56960/60000 (95%)]      Loss: 0.093289
Train Epoch: 3 [57600/60000 (96%)]      Loss: 0.148602
Train Epoch: 3 [58240/60000 (97%)]      Loss: 0.218205
Train Epoch: 3 [58880/60000 (98%)]      Loss: 0.094561
Train Epoch: 3 [59520/60000 (99%)]      Loss: 0.172783

Test set: Avg. loss: 0.1151, Accuracy: 9659/10000 (97%)